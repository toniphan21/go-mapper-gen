@go.Package { name = "github.com/toniphan21/go-mapper-gen/internal/config" }
module gomappergen.Config

import "package://pkg.pkl-lang.org/pkl-go/pkl.golang@0.11.1#/go.pkl"

typealias PackagePath = String

class Output {
  package: String?
  file_name: String?
  test_file_name: String?
}

open class Base {
  output: Output?
}

class BuiltInConverter {
  enable_identical: Boolean = true
  enable_slice: Boolean = true
  enable_type_to_pointer: Boolean = true
  enable_pointer_to_type: Boolean = true
  enable_functions: Boolean = true
}

class Converter {
  built_in: BuiltInConverter = new BuiltInConverter {}
  functions: Listing<String>?
}

class Fields {
  match: "exact" | "ignore-case" = "ignore-case"

  map: Mapping<String, String>?
}

class MapperStruct {
  target_pkg: String?
  target_struct_name: String?
  source_pkg: String?
  source_struct_name: String?
  source_to_target_function_name: String?
  source_from_target_function_name: String?
  decorate_function_name: String?

  pointer: "none" | "source-only" | "target-only" | "both" = "none"

  fields: Fields = new Fields {
    match = "ignore-case"
  }

  generate_source_to_target: Boolean = true
  generate_source_from_target: Boolean = true
}

open class BaseMapper extends Base {
  interface_name: String = "iMapper"
  implementation_name: String = "iMapperImpl"
  constructor_name: String = "new_iMapper"

  source_to_target_function_name: String = "To{TargetStructName}"
  source_from_target_function_name: String = "From{TargetStructName}"

  decorator_interface_name: String = "iMapperDecorator"
  decorator_noop_name: String = "iMapperDecoratorNoOp"
  decorate_function_name: String = "decorate{FunctionName}"

  target_pkg: String = "{CurrentPackage}"
  source_pkg: String

  structs: Mapping<String, MapperStruct>

  generate_go_doc: Boolean = true
}

class Mapper extends BaseMapper {
  priorities: Mapping<Int, BaseMapper>?
}

all: Base = new Base {
  output {
    package = "{CurrentPackageName}"
    file_name = "gen_mapper.go"
    test_file_name = "gen_mapper_test.go"
  }
}

converter: Converter = new Converter {}

packages: Mapping<PackagePath, Mapper>
