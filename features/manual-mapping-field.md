## Manual mapping field

Firstly, let set up an empty golang project without any dependency.

```go.mod
module github.com/toniphan21/go-mapper-gen/mapping

go 1.25
```

Given your source code is

```go
// file: code.go

package mapping

type Target struct {
	ID        string
	FirstName string
	LastName  string
	Email     string
}

type Source struct {
	Id        string
	Surname   string
	GivenName string
	Email     string
}
```

### Change fields match

By default, the field name is matched with case-insensitive, you can change it to
sensitive using `{ fields { match = "exact" } }`.

With this configuration, there only one field matched - Email. The unmatch fields
can be manipulated via Decorator.

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/mapping"] {
		source_pkg = "{CurrentPackage}"

		structs {
			["Target"] { 
				source_struct_name = "Source"
				
				fields {
					match = "exact"
				}
			}
		}
	}
}
```

The generated code is

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package mapping

type iMapper interface {
	// ToTarget converts a Source value into a Target value.
	ToTarget(in Source) Target

	// FromTarget converts a Target value into a Source value.
	FromTarget(in Target) Source
}

type iMapperDecorator interface {
	decorateToTarget(in *Source, out *Target)

	decorateFromTarget(in *Target, out *Source)
}

func new_iMapper(decorator iMapperDecorator) iMapper {
	return &iMapperImpl{decorator: decorator}
}

type iMapperImpl struct {
	decorator iMapperDecorator
}

func (m *iMapperImpl) ToTarget(in Source) Target {
	var out Target

	out.Email = in.Email

	if m.decorator != nil {
		m.decorator.decorateToTarget(&in, &out)
	}

	return out
}

func (m *iMapperImpl) FromTarget(in Target) Source {
	var out Source

	out.Email = in.Email

	if m.decorator != nil {
		m.decorator.decorateFromTarget(&in, &out)
	}

	return out
}

type iMapperDecoratorNoOp struct{}

func (d *iMapperDecoratorNoOp) decorateToTarget(in *Source, out *Target) {
	// Fields that could not be mapped:
	// out.ID =
	// out.FirstName =
	// out.LastName =
}

func (d *iMapperDecoratorNoOp) decorateFromTarget(in *Target, out *Source) {
	// Fields that could not be mapped:
	// out.Id =
	// out.Surname =
	// out.GivenName =
}

var _ iMapper = (*iMapperImpl)(nil)
var _ iMapperDecorator = (*iMapperDecoratorNoOp)(nil)
```

[//]: # (EmitCode:examples/field-mapping/01-fields-match)

### Manual map fields

You can use `{ fields { map { ["column"] = "column" } }` to manually mapping field together:

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/mapping"] {
		source_pkg = "{CurrentPackage}"

		structs {
			["Target"] { 
				source_struct_name = "Source"
				
				fields {
					match = "exact"
					
					map {
						["ID"] = "Id"
						["FirstName"] = "GivenName"
						["LastName"] = "Surname"
					}
				}
			}
		}
	}
}
```

The generated code is

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package mapping

type iMapper interface {
	// ToTarget converts a Source value into a Target value.
	ToTarget(in Source) Target

	// FromTarget converts a Target value into a Source value.
	FromTarget(in Target) Source
}

func new_iMapper() iMapper {
	return &iMapperImpl{}
}

type iMapperImpl struct{}

func (m *iMapperImpl) ToTarget(in Source) Target {
	var out Target

	out.ID = in.Id
	out.FirstName = in.GivenName
	out.LastName = in.Surname
	out.Email = in.Email

	return out
}

func (m *iMapperImpl) FromTarget(in Target) Source {
	var out Source

	out.Id = in.ID
	out.Surname = in.LastName
	out.GivenName = in.FirstName
	out.Email = in.Email

	return out
}

var _ iMapper = (*iMapperImpl)(nil)
```

[//]: # (EmitCode:examples/field-mapping/02-manual-mapping-fields)

### Use function to convert individual field

Given that you have some functions to perform a data conversion:

```go
// file: funcs.go

package mapping

import "strings"

func TrimName(in string) string {
	return strings.TrimSpace(in)
}

type helper struct{}

func (h *helper) Trim(in string) string {
	return strings.TrimSpace(in)
}

var Helper = &helper{}
```

You can use `{ fields { target { ["column"] = set.via_function() } }` to apply a custom logic to a field.

Please note that with custom function like that it only apply to one direction. If you set to `target`, it is apply when
convert `source to target`. If you set field in `source` it will apply when convert `source from target`

```pkl
// remember to import "https://github.com/toniphan21/go-mapper-gen/releases/download/current/set.pkl"

packages {
	["github.com/toniphan21/go-mapper-gen/mapping"] {
		source_pkg = "{CurrentPackage}"

		structs {
			["Target"] { 
				source_struct_name = "Source"
				
				// These are shortcut which perform exactly like `{ fields { target ... source ... } }
				// these configs are merged, the config in { fields ... } will override shortcut in here
				// in case field are duplicated.
				target_fields {
					["FirstName"] = set.via_function("github.com/toniphan21/go-mapper-gen/mapping.TrimName")
				}
				source_fields {
					["GivenName"] = set.via_method("github.com/toniphan21/go-mapper-gen/mapping.Helper", "Trim")
				}
				
				fields {
					match = "exact"
					
					map {
						["ID"] = "Id"
						["FirstName"] = "GivenName"
						["LastName"] = "Surname"
					}
					
					target {
						["LastName"] = set.via_function("github.com/toniphan21/go-mapper-gen/mapping.TrimName")
					}
					
					source {
						["Surname"] = set.via_method("github.com/toniphan21/go-mapper-gen/mapping.Helper", "Trim")
					}
				}
			}
		}
	}
}
```

The generated file is:

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package mapping

type iMapper interface {
	// ToTarget converts a Source value into a Target value.
	ToTarget(in Source) Target

	// FromTarget converts a Target value into a Source value.
	FromTarget(in Target) Source
}

func new_iMapper() iMapper {
	return &iMapperImpl{}
}

type iMapperImpl struct{}

func (m *iMapperImpl) ToTarget(in Source) Target {
	var out Target

	out.ID = in.Id
	out.FirstName = TrimName(in.GivenName)
	out.LastName = TrimName(in.Surname)
	out.Email = in.Email

	return out
}

func (m *iMapperImpl) FromTarget(in Target) Source {
	var out Source

	out.Id = in.ID
	out.Surname = Helper.Trim(in.LastName)
	out.GivenName = Helper.Trim(in.FirstName)
	out.Email = in.Email

	return out
}

var _ iMapper = (*iMapperImpl)(nil)
```

[//]: # (EmitCode:examples/field-mapping/03-use-function-on-individual-field)
