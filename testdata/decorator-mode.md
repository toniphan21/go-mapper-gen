## Decorator Mode

Firstly, let set up an empty golang project without any dependency.

```go.mod
module github.com/toniphan21/go-mapper-gen/decorator

go 1.25
```

Given that you have 3 structs in your source code:

```go
// file: code.go
//go:generate go run github.com/toniphan21/go-mapper-gen/cmd/generator

package decorator

type User struct {
	ID   string
	Name string
}

type UserEntity struct {
	ID    string
	Email string
}

type UserMessage struct {
	ID    string
	Name  string
}
```

### mode types (default); decorator_mode adaptive (default)

#### User <-> UserEntity

Because User <-> UserEntity is not mappable so decorator will be emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserEntity" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

type iMapper interface {
	// ToUser converts a UserEntity value into a User value.
	ToUser(in UserEntity) User

	// FromUser converts a User value into a UserEntity value.
	FromUser(in User) UserEntity
}

type iMapperDecorator interface {
	decorateToUser(in *UserEntity, out *User)

	decorateFromUser(in *User, out *UserEntity)
}

func new_iMapper(decorator iMapperDecorator) iMapper {
	return &iMapperImpl{decorator: decorator}
}

type iMapperImpl struct {
	decorator iMapperDecorator
}

func (m *iMapperImpl) ToUser(in UserEntity) User {
	var out User

	out.ID = in.ID

	if m.decorator != nil {
		m.decorator.decorateToUser(&in, &out)
	}

	return out
}

func (m *iMapperImpl) FromUser(in User) UserEntity {
	var out UserEntity

	out.ID = in.ID

	if m.decorator != nil {
		m.decorator.decorateFromUser(&in, &out)
	}

	return out
}

type iMapperDecoratorNoOp struct{}

func (d *iMapperDecoratorNoOp) decorateToUser(in *UserEntity, out *User) {
	// Fields that could not be mapped:
	// out.Name =
}

func (d *iMapperDecoratorNoOp) decorateFromUser(in *User, out *UserEntity) {
	// Fields that could not be mapped:
	// out.Email =
}

var _ iMapper = (*iMapperImpl)(nil)
var _ iMapperDecorator = (*iMapperDecoratorNoOp)(nil)
```
[//]: # (EmitCode:testdata/golden/decorator-mode/01-mode-types-adaptive-unmappable)

#### User <-> UserMessage

Because User <-> UserMessage is mappable so decorator will not be emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserMessage" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

type iMapper interface {
	// ToUser converts a UserMessage value into a User value.
	ToUser(in UserMessage) User

	// FromUser converts a User value into a UserMessage value.
	FromUser(in User) UserMessage
}

func new_iMapper() iMapper {
	return &iMapperImpl{}
}

type iMapperImpl struct{}

func (m *iMapperImpl) ToUser(in UserMessage) User {
	var out User

	out.ID = in.ID
	out.Name = in.Name

	return out
}

func (m *iMapperImpl) FromUser(in User) UserMessage {
	var out UserMessage

	out.ID = in.ID
	out.Name = in.Name

	return out
}

var _ iMapper = (*iMapperImpl)(nil)
```

[//]: # (EmitCode:testdata/golden/decorator-mode/02-mode-types-adaptive-mappable)

### mode types (default); decorator_mode always

#### User <-> UserEntity

Decorator is always emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		source_pkg = "{CurrentPackage}"
		decorator_mode = "always"

		structs {
			["User"] { source_struct_name = "UserEntity" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

type iMapper interface {
	// ToUser converts a UserEntity value into a User value.
	ToUser(in UserEntity) User

	// FromUser converts a User value into a UserEntity value.
	FromUser(in User) UserEntity
}

type iMapperDecorator interface {
	decorateToUser(in *UserEntity, out *User)

	decorateFromUser(in *User, out *UserEntity)
}

func new_iMapper(decorator iMapperDecorator) iMapper {
	return &iMapperImpl{decorator: decorator}
}

type iMapperImpl struct {
	decorator iMapperDecorator
}

func (m *iMapperImpl) ToUser(in UserEntity) User {
	var out User

	out.ID = in.ID

	if m.decorator != nil {
		m.decorator.decorateToUser(&in, &out)
	}

	return out
}

func (m *iMapperImpl) FromUser(in User) UserEntity {
	var out UserEntity

	out.ID = in.ID

	if m.decorator != nil {
		m.decorator.decorateFromUser(&in, &out)
	}

	return out
}

type iMapperDecoratorNoOp struct{}

func (d *iMapperDecoratorNoOp) decorateToUser(in *UserEntity, out *User) {
	// Fields that could not be mapped:
	// out.Name =
}

func (d *iMapperDecoratorNoOp) decorateFromUser(in *User, out *UserEntity) {
	// Fields that could not be mapped:
	// out.Email =
}

var _ iMapper = (*iMapperImpl)(nil)
var _ iMapperDecorator = (*iMapperDecoratorNoOp)(nil)
```
[//]: # (EmitCode:testdata/golden/decorator-mode/03-mode-types-always-unmappable)

### mode types (default); decorator_mode never

#### User <-> UserEntity

Because User <-> UserEntity is not mappable but decorator never emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		source_pkg = "{CurrentPackage}"
		decorator_mode = "never"

		structs {
			["User"] { source_struct_name = "UserEntity" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

type iMapper interface {
	// ToUser converts a UserEntity value into a User value.
	ToUser(in UserEntity) User

	// FromUser converts a User value into a UserEntity value.
	FromUser(in User) UserEntity
}

func new_iMapper() iMapper {
	return &iMapperImpl{}
}

type iMapperImpl struct{}

func (m *iMapperImpl) ToUser(in UserEntity) User {
	var out User

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Name =

	return out
}

func (m *iMapperImpl) FromUser(in User) UserEntity {
	var out UserEntity

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Email =

	return out
}

var _ iMapper = (*iMapperImpl)(nil)
```

[//]: # (EmitCode:testdata/golden/decorator-mode/05-mode-types-never-unmappable)

#### User <-> UserMessage

Decorator never emitted.

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		source_pkg = "{CurrentPackage}"
		decorator_mode = "never"

		structs {
			["User"] { source_struct_name = "UserMessage" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

type iMapper interface {
	// ToUser converts a UserMessage value into a User value.
	ToUser(in UserMessage) User

	// FromUser converts a User value into a UserMessage value.
	FromUser(in User) UserMessage
}

func new_iMapper() iMapper {
	return &iMapperImpl{}
}

type iMapperImpl struct{}

func (m *iMapperImpl) ToUser(in UserMessage) User {
	var out User

	out.ID = in.ID
	out.Name = in.Name

	return out
}

func (m *iMapperImpl) FromUser(in User) UserMessage {
	var out UserMessage

	out.ID = in.ID
	out.Name = in.Name

	return out
}

var _ iMapper = (*iMapperImpl)(nil)
```

[//]: # (EmitCode:testdata/golden/decorator-mode/06-mode-types-never-mappable)

### mode functions; decorator_mode adaptive (default)

#### User <-> UserEntity

Because User <-> UserEntity is not mappable so decorator will be emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		mode = "functions"
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserEntity" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

// ToUser converts a UserEntity value into a User value.
func ToUser(in UserEntity, decorators ...func(*UserEntity, *User)) User {
	var out User

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Name =

	for _, decorate := range decorators {
		decorate(&in, &out)
	}

	return out
}

// FromUser converts a User value into a UserEntity value.
func FromUser(in User, decorators ...func(*User, *UserEntity)) UserEntity {
	var out UserEntity

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Email =

	for _, decorate := range decorators {
		decorate(&in, &out)
	}

	return out
}
```

[//]: # (EmitCode:testdata/golden/decorator-mode/07-mode-functions-adaptive-unmappable)

#### User <-> UserMessage

Because User <-> UserMessage is mappable so decorator will not be emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		mode = "functions"
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserMessage" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

// ToUser converts a UserMessage value into a User value.
func ToUser(in UserMessage) User {
	var out User

	out.ID = in.ID
	out.Name = in.Name

	return out
}

// FromUser converts a User value into a UserMessage value.
func FromUser(in User) UserMessage {
	var out UserMessage

	out.ID = in.ID
	out.Name = in.Name

	return out
}
```

[//]: # (EmitCode:testdata/golden/decorator-mode/08-mode-functions-adaptive-mappable)

### mode functions; decorator_mode always

#### User <-> UserEntity

Decorator always emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		mode = "functions"
		decorator_mode = "always"
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserEntity" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

// ToUser converts a UserEntity value into a User value.
func ToUser(in UserEntity, decorators ...func(*UserEntity, *User)) User {
	var out User

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Name =

	for _, decorate := range decorators {
		decorate(&in, &out)
	}

	return out
}

// FromUser converts a User value into a UserEntity value.
func FromUser(in User, decorators ...func(*User, *UserEntity)) UserEntity {
	var out UserEntity

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Email =

	for _, decorate := range decorators {
		decorate(&in, &out)
	}

	return out
}
```

[//]: # (EmitCode:testdata/golden/decorator-mode/09-mode-functions-always-unmappable)

#### User <-> UserMessage

Decorator always emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		mode = "functions"
		decorator_mode = "always"
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserMessage" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

// ToUser converts a UserMessage value into a User value.
func ToUser(in UserMessage, decorators ...func(*UserMessage, *User)) User {
	var out User

	out.ID = in.ID
	out.Name = in.Name

	for _, decorate := range decorators {
		decorate(&in, &out)
	}

	return out
}

// FromUser converts a User value into a UserMessage value.
func FromUser(in User, decorators ...func(*User, *UserMessage)) UserMessage {
	var out UserMessage

	out.ID = in.ID
	out.Name = in.Name

	for _, decorate := range decorators {
		decorate(&in, &out)
	}

	return out
}
```

[//]: # (EmitCode:testdata/golden/decorator-mode/10-mode-functions-always-mappable)

### mode functions; decorator_mode never

#### User <-> UserEntity

Because User <-> UserEntity is not mappable but decorator never emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		mode = "functions"
		decorator_mode = "never"
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserEntity" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

// ToUser converts a UserEntity value into a User value.
func ToUser(in UserEntity) User {
	var out User

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Name =

	return out
}

// FromUser converts a User value into a UserEntity value.
func FromUser(in User) UserEntity {
	var out UserEntity

	out.ID = in.ID

	// Fields that could not be mapped:
	// out.Email =

	return out
}
```

[//]: # (EmitCode:testdata/golden/decorator-mode/11-mode-functions-never-unmappable)

#### User <-> UserMessage

Decorator never emitted

```pkl
packages {
	["github.com/toniphan21/go-mapper-gen/decorator"] {
		mode = "functions"
		decorator_mode = "never"
		source_pkg = "{CurrentPackage}"

		structs {
			["User"] { source_struct_name = "UserMessage" }
		}
	}
}
```

```go
// golden-file: gen_mapper.go
// Code generated by github.com/toniphan21/go-mapper-gen - test, DO NOT EDIT.

package decorator

// ToUser converts a UserMessage value into a User value.
func ToUser(in UserMessage) User {
	var out User

	out.ID = in.ID
	out.Name = in.Name

	return out
}

// FromUser converts a User value into a UserMessage value.
func FromUser(in User) UserMessage {
	var out UserMessage

	out.ID = in.ID
	out.Name = in.Name

	return out
}
```

[//]: # (EmitCode:testdata/golden/decorator-mode/12-mode-functions-never-mappable)

